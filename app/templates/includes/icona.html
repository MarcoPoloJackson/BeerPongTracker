{% extends "base.html" %}

{% block body_class %}icon-page{% endblock %}

{% block title %}Profilo di {{ player_name }}{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/icona.css') }}">
{% endblock %}

{% block content %}
<div class="icon-container">
    <div class="current-icon-display">
        {{ current_icon or (player_name[:1]|upper) }}
    </div>
    
    <h2>Profilo di {{ player_name }}</h2>

    <div class="top-nav-wrapper">
        <a href="{{ url_for('main.home') }}" class="btn-home-top">ğŸ  Torna alla Home</a>
    </div>

    <div class="profile-section">
        <form action="{{ url_for('main.update_icon') }}" method="POST">
            <label for="new_name">ğŸ‘¤ Nome Account</label>
            <div class="input-group">
                <input type="text" name="new_name" id="new_name" 
                       value="{{ player_name }}" class="input-field" 
                       required minlength="3" maxlength="20">
                <button type="submit" class="btn-save">Aggiorna</button>
            </div>
        </form>
    </div>

    <div class="profile-section">
        <form id="passwordForm" action="{{ url_for('main.update_icon') }}" method="POST">
            <label for="new_password">ğŸ” Nuova Password</label>
            <div class="input-group">
                <input type="password" name="new_password" id="new_password" placeholder="Scrivi qui..." class="input-field" autocomplete="new-password">
                <button type="submit" class="btn-save btn-orange">Aggiorna</button>
            </div>
        </form>
    </div>

    <div class="profile-section">
        <form action="{{ url_for('main.update_icon') }}" method="POST">
            <label for="fav_drink">ğŸº Drink Preferito</label>
            <div class="input-group">
                <input type="text" name="fav_drink" id="fav_drink" value="{{ fav_drink or 'Birra' }}" class="input-field">
                <button type="submit" class="btn-save">Salva</button>
            </div>
        </form>
    </div>

    <div class="emoji-grid-container">
        <h3>Scegli il tuo Avatar</h3>
        <form action="{{ url_for('main.update_icon') }}" method="POST">
            <div class="emoji-grid">
                {% set emojis = [
                    'ğŸº','ğŸ»','ğŸ¥‚','ğŸ·','ğŸ¥ƒ','ğŸ¸','ğŸ¹','ğŸ¾','ğŸ•','ğŸ”','ğŸŒ­','ğŸ¿','ğŸ§€','ğŸŒ¶ï¸','ğŸ„','ğŸŒ®','ğŸ–',
                    'ğŸ˜','ğŸ¤ ','ğŸ¤¡','ğŸ¤‘','ğŸ¤“','ğŸ¤–','ğŸƒ','ğŸ‘½','ğŸ’©','ğŸ’€','â˜ ï¸','ğŸ‘º','ğŸ‘¹','ğŸ¤¬','ğŸ¤¯','ğŸ¥¶','ğŸ¥µ','ğŸ˜±','ğŸ¤ª','ğŸ«¡','ğŸ«£','ğŸ« ','ğŸ¤¥','ğŸ¤«','ğŸ¤¨','ğŸ§','ğŸ˜´','ğŸ˜·','ğŸ˜ˆ','ğŸ‘¿',
                    'ğŸ¦','ğŸ¯','ğŸ»','ğŸ¨','ğŸ¼','ğŸ¶','ğŸ±','ğŸ¦Š','ğŸ¸','ğŸ™','ğŸ¦ˆ','ğŸ¦–','ğŸ¦•','ğŸ¦','ğŸ˜','ğŸ¦›','ğŸ¦','ğŸ¦’','ğŸ¦˜','ğŸ§','ğŸ¦','ğŸ¦…','ğŸ¦‰','ğŸ¦‡','ğŸº','ğŸ—','ğŸ´','ğŸ¦„','ğŸ','ğŸ','ğŸ•·ï¸','ğŸ','ğŸ¢','ğŸŠ',
                    'ğŸ¦¸','ğŸ¦¹','ğŸ§Ÿ','ğŸ§›','ğŸ§','ğŸ§œ','ğŸ§š','ğŸ§™','ğŸ¥·','ğŸ’‚','ğŸ•µï¸','ğŸ‘·','ğŸ¤´','ğŸ‘¸','ğŸ•º','ğŸ’ƒ',
                    'ğŸš€','ğŸ›¸','âš“','ğŸ’£','ğŸ§¨','ğŸˆ','ğŸ‰','ğŸŠ','ğŸ','ğŸ†','ğŸ¥‡','ğŸ°','ğŸ²','ğŸ®','ğŸ•¹ï¸','ğŸ±','ğŸ¯','ğŸ³','ğŸ¥Š','ğŸ¥‹','âš½','ğŸ€','ğŸˆ','âš¾','ğŸ¾','ğŸ','ğŸ‰','ğŸ“','ğŸ¸','â›³','ğŸ£',
                    'ğŸ’','ğŸ‘‘','ğŸ’','ğŸ•¶ï¸','ğŸ§¢','ğŸ©','ğŸ“','ğŸ’¼','ğŸ”‹','ğŸ’¡','ğŸ’¸','ğŸ’°','ğŸ’³','ğŸ§±','ğŸ”¨','ğŸ§¯','ğŸ§²','ğŸ§¬','ğŸ¦ ','ğŸ’Š','ğŸ’‰','ğŸ§¼','ğŸ§»','ğŸ—¿','ğŸ—½','ğŸ—¼','ğŸ¯','ğŸ°'
                ] %}
                
                {% for em in emojis %}
                    <button type="submit" name="icon" value="{{ em }}" class="emoji-btn">{{ em }}</button>
                {% endfor %}
                
                <button type="submit" name="icon" value="" class="emoji-btn reset-btn">TXT</button>
            </div>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const passwordForm = document.getElementById('passwordForm');
        const passwordInput = document.getElementById('new_password');

        passwordForm.addEventListener('submit', function(e) {
            if (passwordInput.value.trim() === "") {
                e.preventDefault();
                passwordInput.style.border = "2px solid #e74c3c";
                passwordInput.placeholder = "Inserisci una password valida!";
                setTimeout(() => {
                    passwordInput.style.border = "none";
                }, 2000);
            }
        });

        const emojiBtns = document.querySelectorAll('.emoji-btn');
        emojiBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                this.style.transform = "scale(0.9)";
            });
        });
    });
</script>
{% endblock %}
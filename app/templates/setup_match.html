<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Draft Arena</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/setup_match.css') }}">
</head>
<body>

<div class="container">
    <h1>{% if match %}MODIFICA ARENA{% else %}NUOVO MATCH{% endif %}</h1>

    <form method="POST" id="realForm">
        <input type="hidden" name="match_name" id="hidden_match_name">
        <input type="hidden" name="mode" value="squadre">
        {% if match %}<input type="hidden" name="status" value="{{ match.status }}">{% endif %}
        
        <input type="hidden" name="t1_p1" id="input_t1_p1" value="{{ match.t1_p1 if match else '' }}" required>
        <input type="hidden" name="t1_p2" id="input_t1_p2" value="{{ match.t1_p2 if match else '' }}" required>
        <input type="hidden" name="t2_p1" id="input_t2_p1" value="{{ match.t2_p1 if match else '' }}" required>
        <input type="hidden" name="t2_p2" id="input_t2_p2" value="{{ match.t2_p2 if match else '' }}" required>
    </form>

    <div class="match-settings">
        <input type="text" class="input-name" id="ui_match_name" 
               placeholder="Nome Partita (Opzionale)" 
               value="{{ match.match_name if match else '' }}">
    </div>

    <div class="arena-wrapper">
        
        <div class="team-column team-blue">
            <div class="team-header">Blue Team</div>
            
            <div class="slot-card" id="slot_t1_p1" onclick="selectSlot('t1_p1')">
                <div class="slot-pos">Left Wing</div>
                <div class="slot-player-name" id="name_t1_p1">EMPTY</div>
                <div class="remove-btn" onclick="clearSlot('t1_p1', event)">âœ•</div>
            </div>

            <div class="slot-card" id="slot_t1_p2" onclick="selectSlot('t1_p2')">
                <div class="slot-pos">Right Wing</div>
                <div class="slot-player-name" id="name_t1_p2">EMPTY</div>
                <div class="remove-btn" onclick="clearSlot('t1_p2', event)">âœ•</div>
            </div>
        </div>

        <div class="vs-badge">VS</div>

        <div class="team-column team-red">
            <div class="team-header">Red Team</div>

            <div class="slot-card" id="slot_t2_p1" onclick="selectSlot('t2_p1')">
                <div class="slot-pos">Left Wing</div>
                <div class="slot-player-name" id="name_t2_p1">EMPTY</div>
                <div class="remove-btn" onclick="clearSlot('t2_p1', event)">âœ•</div>
            </div>

            <div class="slot-card" id="slot_t2_p2" onclick="selectSlot('t2_p2')">
                <div class="slot-pos">Right Wing</div>
                <div class="slot-player-name" id="name_t2_p2">EMPTY</div>
                <div class="remove-btn" onclick="clearSlot('t2_p2', event)">âœ•</div>
            </div>
        </div>

    </div>

    <div class="roster-section">
        <div class="section-title">Available Players</div>
        <div class="player-grid">
            {% for p in players %}
                {% set is_busy = p.name in busy_players %}
                <div class="player-chip {% if is_busy %}busy{% endif %}" 
                     id="chip_{{ p.name|replace(' ', '_') }}" 
                     onclick="{% if not is_busy %}assignPlayer('{{ p.name }}'){% endif %}">
                    
                    {{ p.name }}
                    {% if is_busy %}<span style="font-size:0.8em; margin-left:5px">ðŸ”’</span>{% endif %}
                </div>
            {% endfor %}
        </div>
    </div>

    <div class="actions">
        <button class="btn-start" onclick="submitGame()">FIGHT!</button>
        <a href="{{ url_for('main.select_player') }}" class="btn-cancel">Torna al menu</a>
    </div>

</div>

<script src="{{ url_for('static', filename='js/setup_match.js') }}"></script>

</body>
</html>
/* ==========================================
   HOME.CSS - Struttura, Storico e Modale
   ========================================== */

@import url('https://fonts.googleapis.com/css2?family=Outfit:wght@400;700;900&display=swap');

:root {
    --bg-page: #eef2f6; 
    --text-dark: #1e293b;
    --text-gray: #64748b;
    
    --blue-primary: #2563eb; 
    --red-primary: #e11d48;
    
    --shadow-history: 0 4px 6px -1px rgba(0,0,0,0.05);
}

body {
    background: var(--bg-page);
    font-family: 'Outfit', sans-serif;
    color: var(--text-dark);
    margin: 0;
    min-height: 100vh;
}

/* --- LAYOUT GENERALE --- */
.home-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 40px 20px;
}

.page-title {
    text-align: center;
    margin-bottom: 5px;
    font-size: 3.5em;
    font-weight: 900;
    text-transform: uppercase;
    letter-spacing: -1px;
    color: var(--text-dark);
    text-shadow: 2px 2px 0px white;
}

.page-subtitle {
    text-align: center;
    color: var(--text-gray);
    margin-bottom: 50px;
    font-size: 1.2em;
    font-weight: 600;
}

.section-label {
    font-size: 0.9em;
    font-weight: 900;
    color: #94a3b8;
    margin-bottom: 25px;
    letter-spacing: 2px;
    text-transform: uppercase;
    display: flex;
    align-items: center;
    gap: 15px;
}
.section-label::after {
    content: '';
    flex: 1;
    height: 2px;
    background: #cbd5e1;
    border-radius: 2px;
}

/* --- ACTION BUTTONS --- */
.action-bar {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-bottom: 60px;
}

.btn-main {
    padding: 16px 32px;
    border-radius: 100px;
    font-weight: 800;
    text-decoration: none;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: white;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    display: flex;
    align-items: center;
    gap: 10px;
}

.btn-new {
    background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
    box-shadow: 0 8px 20px rgba(14, 165, 233, 0.4);
}

.btn-manage {
    background: white;
    color: var(--text-gray);
    box-shadow: 0 8px 20px rgba(0,0,0,0.05);
}

.btn-main:hover {
    transform: translateY(-4px) scale(1.02);
}

/* --- SEZIONE STORICO --- */
.history-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
    gap: 30px;
}

.series-card {
    background: #f8fafc; 
    border-radius: 16px;
    box-shadow: var(--shadow-history);
    border: 1px solid #e2e8f0;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.series-header {
    background: #fff;
    padding: 15px 25px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #e2e8f0;
}

.series-vs {
    font-weight: 800;
    font-size: 0.9em;
    text-transform: uppercase;
}
.team-blue-text { color: var(--blue-primary); }
.team-red-text { color: var(--red-primary); }

.btn-history-rematch {
    background: white;
    color: var(--text-gray);
    border: 1px solid #cbd5e1;
    padding: 8px 16px;
    border-radius: 50px;
    font-weight: 700;
    font-size: 0.75em;
    text-decoration: none;
    text-transform: uppercase;
    transition: all 0.2s;
}
.btn-history-rematch:hover {
    background: var(--text-dark);
    color: white;
    border-color: var(--text-dark);
}

.history-list { display: flex; flex-direction: column; }

.history-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 15px 25px;
    border-bottom: 1px solid #e2e8f0;
}
.history-row:last-child { border-bottom: none; }

.history-row.win-blue { background: rgba(37, 99, 235, 0.05); }
.history-row.win-red { background: rgba(225, 29, 72, 0.05); }

.history-time {
    color: #94a3b8;
    font-weight: 600;
    font-size: 0.8em;
    width: 60px;
}

.history-result-badge {
    font-size: 0.65em;
    font-weight: 900;
    padding: 5px 10px;
    border-radius: 4px;
    text-transform: uppercase;
    width: 80px;
    text-align: center;
    background: #e2e8f0;
    color: #64748b;
}
.win-blue .history-result-badge { background: #dbeafe; color: var(--blue-primary); }
.win-red .history-result-badge { background: #fee2e2; color: var(--red-primary); }

/* --- EMPTY STATE --- */
.empty-state {
    text-align: center;
    padding: 80px;
    background: rgba(255,255,255,0.5);
    border-radius: 20px;
    border: 2px dashed #cbd5e1;
    color: #94a3b8;
    grid-column: 1 / -1;
}
.empty-icon { font-size: 3em; display: block; margin-bottom: 15px; }

/* =========================================
   MODALE SELEZIONE GIOCATORE (FIX SCROLL TOTALE)
   ========================================= */

/* Sfondo scuro che copre tutto */
.modal-overlay {
    display: none;              /* CHIUSO DI DEFAULT */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(15, 23, 42, 0.85);
    backdrop-filter: blur(4px);
    z-index: 9999;

    align-items: center;
    justify-content: center;
    padding: 15px;
    box-sizing: border-box;
}

/* Rende il display 'flex' solo quando è visibile via JS (override inline style) */
.modal-overlay[style*="display: flex"] {
    display: flex !important;
}

/* Contenitore Bianco - La chiave dello scroll */
.modal-content {
    background: #ffffff; 
    width: 100%; 
    max-width: 550px; 
    
    /* ALTEZZA FISSA RELATIVA: Non supera l'80% dello schermo */
    max-height: 80vh; 
    
    /* Flexbox Verticale: 
       1. Header (fisso)
       2. Lista (scrollabile)
       3. Footer (fisso) */
    display: flex;
    flex-direction: column;
    
    border-radius: 24px; 
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
    overflow: hidden; /* Nasconde ciò che esce dagli angoli */
}

/* 1. HEADER (Fisso in alto) */
.modal-content h3 {
    margin: 0;
    padding: 25px 20px 5px 20px;
    font-size: 1.5em;
    color: var(--text-dark);
    font-weight: 800;
    text-align: center;
    flex-shrink: 0; /* Non si schiaccia mai */
}

#modalSlotName {
    color: var(--text-gray);
    font-weight: 600;
    font-size: 0.9em;
    margin: 0;
    padding: 0 20px 15px 20px;
    text-align: center;
    border-bottom: 1px solid #f1f5f9;
    flex-shrink: 0; /* Non si schiaccia mai */
}

/* Form contenitore (necessario perché avvolge la lista) */
#assignForm {
    display: flex;
    flex-direction: column;
    overflow: hidden; /* Passa lo scroll al figlio */
    flex: 1; /* Occupa tutto lo spazio centrale */
    min-height: 0; /* Fix flexbox */
}

/* 2. LISTA GIOCATORI (L'UNICA CHE SCROLLA) */
.player-grid-modal {
    display: grid; 
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); 
    gap: 12px; 
    padding: 15px 20px;
    
    /* ABILITA SCROLL VERTICALE QUI */
    overflow-y: auto; 
    
    /* Smooth scrolling su iPhone */
    -webkit-overflow-scrolling: touch; 
    
    flex: 1; /* Si allarga finché può */
}

/* Scheda Giocatore */
.modal-chip {
    background: white; 
    color: var(--text-dark);
    border: 1px solid #e2e8f0;
    padding: 12px 5px; 
    border-radius: 12px; 
    cursor: pointer; 
    font-weight: 700;
    font-size: 0.9em; 
    transition: all 0.1s ease;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    min-height: 55px; 
    word-break: break-word; 
    line-height: 1.2;
}

.modal-chip:hover { 
    background: #eff6ff; 
    border-color: var(--blue-primary); 
    color: var(--blue-primary); 
    transform: translateY(-2px);
    box-shadow: 0 4px 10px rgba(37, 99, 235, 0.15);
}

.modal-chip.busy { 
    opacity: 0.5; 
    pointer-events: none; 
    background: #f8fafc; 
    color: #94a3b8;
    border-color: transparent;
    box-shadow: none;
}

/* 3. FOOTER (Pulsante Annulla - Fisso in basso) */
.modal-content button[onclick*="none"] {
    margin: 15px 20px 25px 20px;
    background: #f1f5f9;
    border: none;
    padding: 14px;
    border-radius: 12px;
    color: var(--text-gray);
    font-weight: 700;
    cursor: pointer;
    font-size: 0.9em;
    text-transform: uppercase;
    letter-spacing: 1px;
    transition: 0.2s;
    flex-shrink: 0; /* Non sparisce mai */
}

.modal-content button[onclick*="none"]:hover {
    background: #e2e8f0;
    color: var(--text-dark);
}

/* Scrollbar personalizzata */
.player-grid-modal::-webkit-scrollbar { width: 6px; }
.player-grid-modal::-webkit-scrollbar-track { background: transparent; }
.player-grid-modal::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }

@keyframes fadeIn { 
    from { opacity: 0; transform: scale(0.95); } 
    to { opacity: 1; transform: scale(1); } 
}

/* ==========================================
   MODALE KICK (RIMOZIONE GIOCATORE)
   ========================================== */

.kick-header-icon {
    font-size: 3rem;
    display: block;
    margin: 20px auto 10px auto;
    text-align: center;
    animation: bounce 0.5s;
}

.kick-message {
    text-align: center;
    padding: 0 25px;
    font-size: 1.1rem;
    color: var(--text-dark);
    line-height: 1.5;
}

.kick-message strong {
    color: var(--red-primary);
    font-weight: 900;
}

.modal-actions {
    display: flex;
    gap: 15px;
    padding: 25px;
    justify-content: center;
}

.btn-modal {
    flex: 1;
    padding: 15px;
    border-radius: 12px;
    border: none;
    font-weight: 800;
    font-size: 1rem;
    cursor: pointer;
    text-transform: uppercase;
    transition: transform 0.2s;
}

.btn-modal:hover { transform: translateY(-3px); }

.btn-cancel {
    background: #f1f5f9;
    color: var(--text-gray);
}

.btn-confirm-kick {
    background: var(--red-primary); /* Rosso */
    color: white;
    box-shadow: 0 4px 15px rgba(225, 29, 72, 0.4);
}

@keyframes bounce {
    0%, 20%, 50%, 80%, 100% {transform: translateY(0);} 
    40% {transform: translateY(-20px);} 
    60% {transform: translateY(-10px);} 
}


/* --- NUOVO STILE STORICO --- */

.team-names-hist {
    font-size: 1.1em;
    font-weight: 800;
    display: flex;
    align-items: center;
    gap: 10px;
    flex-wrap: wrap; /* Va a capo su mobile */
}

.vs-divider {
    color: #cbd5e1;
    font-size: 0.8em;
    font-weight: 600;
    margin: 0 5px;
}

.history-score-box {
    display: flex;
    align-items: center;
    gap: 8px;
    font-family: 'Outfit', monospace;
    font-size: 1.5em; /* Punteggio grande */
    font-weight: 900;
    margin: 0 20px;
    flex-grow: 1; /* Si prende lo spazio centrale */
    justify-content: center;
}

.score-val.blue { color: #2563eb; }
.score-val.red { color: #e11d48; }

/* Evidenzia il numero vincente */
.score-val.winner {
    transform: scale(1.2);
    text-shadow: 0 2px 10px rgba(0,0,0,0.1);
}

.score-dash { color: #94a3b8; font-weight: 400; }

.history-winner-label {
    font-size: 0.7em;
    font-weight: 800;
    padding: 4px 8px;
    border-radius: 4px;
    background: rgba(255,255,255,0.6);
    color: #64748b;
    width: 60px;
    text-align: center;
}

/* Bordi laterali colorati per identificare subito chi ha vinto la riga */
.history-row.win-blue { border-left: 5px solid #2563eb; background: linear-gradient(90deg, #eff6ff 0%, transparent 100%); }
.history-row.win-red { border-left: 5px solid #e11d48; background: linear-gradient(90deg, #fef2f2 0%, transparent 100%); }

/* Incolla alla fine di home.css */

.modal-chip.chip-none {
    background-color: #2d3436; /* Grigio scuro/Nero */
    color: #ff7675; /* Rosso chiaro */
    border: 1px dashed #ff7675;
    font-weight: bold;
    order: -1; /* Forza questo elemento a stare sempre per primo */
}

.modal-chip.chip-none:hover {
    background-color: #ff7675;
    color: white;
    border-style: solid;
    transform: scale(1.05);
}

@media (max-width: 600px) {
    /* --- FIX GRIGLIA GENERALE --- */
    .history-grid {
        display: flex;       /* Meglio di grid su mobile per impilare */
        flex-direction: column;
        width: 100%;         /* Riempie tutto lo spazio disponibile */
        margin: 0;           /* Rimuove margini esterni che causano sbordature */
        padding: 0;          /* Rimuove padding extra */
        gap: 20px;           /* Spazio tra le card */
    }

    .page-subtitle{
        font-size: 20px;
        margin-bottom: 30px;
    }
    /* --- FIX CARD --- */
    .series-card {
        width: 100%;            /* Forza la larghezza al 100% del contenitore */
        box-sizing: border-box; /* IMPERATIVO: fa sì che il padding non aumenti la larghezza totale */
        margin: 0 auto;         /* Centra la card se dovesse essere più piccola */
    }

    /* --- FIX HEADER (VS e Bottone) --- */
    .series-header {
        display: flex;
        flex-direction: column; /* Impila verticale */
        align-items: center;    /* <--- QUESTO CENTRA GLI ELEMENTI ORIZZONTALMENTE */
        text-align: center;     /* Centra il testo */
        padding: 15px;
        gap: 15px;
    }

    /* Centra anche i nomi delle squadre dentro l'header */
    .team-names-hist {
        justify-content: center; 
        width: 100%;
        flex-wrap: wrap; /* Se i nomi sono lunghissimi vanno a capo invece di sbordare */
    }

    /* --- FIX RIGHE STORICO --- */
    .history-row {
        display: flex;
        flex-wrap: wrap; 
        justify-content: center; /* Centra tutto il contenuto della riga */
        padding: 10px;
        text-align: center;
    }

    /* --- FIX BOX PUNTEGGIO --- */
    .history-score-box {
        margin: 8px 0;
        width: 100%;        /* Occupa tutta la riga */
        display: flex;
        justify-content: center; /* Centra i numeri del punteggio */
        order: 3;           /* Mantiene la tua preferenza di ordine */
    }

    .history-time, .history-winner-label {
        width: auto;        /* Lascia che occupino lo spazio necessario */
        font-size: 0.85em;  /* Leggermente più piccolo su mobile */
    }
    
    /* --- FIX ACTION BAR (Pulsanti in alto) --- */
    .action-bar {
        flex-direction: column;
        align-items: center; /* Centra i pulsanti */
        width: 100%;
        gap: 10px;
    }
    
    .btn-main {
        width: 100%;        /* Bottoni a larghezza piena */
        box-sizing: border-box; /* Evita che il padding del bottone lo faccia uscire */
        justify-content: center;
    }
}